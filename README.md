# ESP32-S3 光流传感器 Web 仪表盘

基于ESP32-S3的Web仪表盘项目，用于实时显示PV3953L1光流传感器数据。

## 功能特点

- 通过串口读取光流传感器数据
- 实时Web界面显示光流数据和高度信息
- 使用Chart.js实现数据可视化
- 支持光流方向矢量可视化
- 可自定义数据刷新频率和历史数据点数量
- 响应式设计，适配不同设备

## 硬件要求

- ESP32-S3开发板
- PV3953L1光流定点激光定高模块（PMW3901+VL53L1X）
- 必要的连接线

## PV3953L1模块规格

- 工作电压：3.3V（注意：**不能接5V**，否则会烧毁模块）
- 接口：1.0间距4P座子
- 定点范围：8cm-400cm
- 定高范围：4cm-400cm
- 串口通信：TTL电平，波特率19200bps
- 数据帧率：约66fps
- 接线标识：V（3.3V）、T（发送）、R（接收）、G（GND）

## 接线方式

1. ESP32-S3 GPIO18 (RX) → PV3953L1 T（发送）
2. ESP32-S3 GPIO17 (TX) → PV3953L1 R（接收）
3. ESP32-S3 3.3V → PV3953L1 V（电源）
4. ESP32-S3 GND → PV3953L1 G（地）

**警告：** 必须使用3.3V供电，不能使用5V，否则会烧毁模块！

## 开发环境设置

本项目基于PlatformIO开发环境。如果您使用Arduino IDE，需要手动安装所需的库。

### 所需库

- ESPAsyncWebServer
- ArduinoJson
- LittleFS

## 使用方法

1. 根据接线方式连接ESP32-S3和PV3953L1光流传感器模块
2. 修改`src/main.cpp`中的WiFi配置（SSID和密码）
3. 使用PlatformIO编译并上传代码到ESP32-S3
4. 使用串口监视器查看设备IP地址
5. 在浏览器中访问设备IP地址即可查看Web仪表盘

## 数据协议说明

PV3953L1光流传感器数据包格式：
- 包头：0xFE
- 字节数：0x04
- 光流数据X：DATA0、DATA1（低字节在前）
- 光流数据Y：DATA2、DATA3（低字节在前）
- 高度数据Z：DATA4、DATA5（单位：厘米）
- 校验和：DATA0~DATA5六个字节累加值
- 地面环境质量值：数值越大表示环境质量越高
- 包尾：0xAA

## 系统架构

1. ESP32-S3通过串口接收光流传感器数据
2. 解析数据并存储在内存中
3. 内置Web服务器提供HTML、CSS和JavaScript文件
4. 前端使用Chart.js进行数据可视化
5. 通过Ajax请求实时更新数据

## 光流数据处理说明

光流传感器输出的原始数据需要进行以下处理：
- 对积分位移进行低通滤波
- 用姿态角补偿积分位移
- 对积分位移进行微分处理得到速度
- 将数据单位转换为厘米

## 许可证

本项目采用MIT许可证。

## 贡献

欢迎提交问题和建议！ 